<!DOCTYPE html>
<html lang="ru">
<head>
  <meta charset="UTF-8"/>
  <meta name="viewport" content="width=device-width,initial-scale=1.0"/>
  <title>–†—É–ª–µ—Ç–∫–∞</title>
  <style>
    body{margin:0;font-family:Arial;background:#111;color:#fff;text-align:center;padding:20px}
    #wheel{width:200px;height:200px;border-radius:50%;border:6px solid gold;margin:20px auto;
           background:conic-gradient(#e74c3c 0 36deg,#f1c40f 36 72deg,#2ecc71 72 108deg,
                                     #3498db 108 144deg,#9b59b6 144 180deg,#e74c3c 180 216deg,
                                     #f1c40f 216 252deg,#2ecc71 252 288deg,#3498db 288 324deg,
                                     #9b59b6 324 360deg);
           transition:transform 4s cubic-bezier(.2,.8,.2,1);}
    button{padding:10px 20px;font-size:16px;margin:10px 5px;border:none;border-radius:8px;background:#0099ff;color:#fff}
    #balance{margin:15px;font-size:18px}
  </style>
</head>
<body>
  <h1>üé∞ –†—É–ª–µ—Ç–∫–∞</h1>
  <div id="balance">–ó–∞–≥—Ä—É–∑–∫–∞...</div>
  <div id="wheel"></div>
  <div>
    <input id="bet" type="number" min="10" step="10" value="10" style="width:80px"/>
    <input id="sector" type="number" min="1" max="10" value="5" style="width:50px"/>
    <button onclick="spin()">–ö—Ä—É—Ç–∏—Ç—å</button>
  </div>
  <div id="msg"></div>

<script>
const uid = new URLSearchParams(location.search).get('uid');
let balance = 0;

async function api(path, data) {
  const r = await fetch(path, {method:'POST', headers:{'Content-Type':'application/json'}, body:JSON.stringify(data)});
  return r.json();
}

async function loadBalance() {
  const res = await api('/balance', {user_id: uid}); // –º–æ–∂–Ω–æ –¥–æ–±–∞–≤–∏—Ç—å –æ—Ç–¥–µ–ª—å–Ω—ã–π —ç–Ω–¥-–ø–æ–∏–Ω—Ç
  balance = res.balance || 0;
  document.getElementById('balance').innerText = `–ë–∞–ª–∞–Ω—Å: ${balance} ‚≠ê`;
}

async function spin() {
  const bet = +document.getElementById('bet').value;
  const sector = +document.getElementById('sector').value;
  if(bet < 10 || bet > balance) return alert('–°—Ç–∞–≤–∫–∞ –æ—Ç 10 –¥–æ —Ç–µ–∫—É—â–µ–≥–æ –±–∞–ª–∞–Ω—Å–∞');
  const res = await api('/spin', {user_id: uid, bet, sector});
  if(res.error) return alert(res.error);
  balance = res.new_balance;
  document.getElementById('balance').innerText = `–ë–∞–ª–∞–Ω—Å: ${balance} ‚≠ê`;
  document.getElementById('msg').innerText = res.message;
  // –∞–Ω–∏–º–∞—Ü–∏—è
  const wheel = document.getElementById('wheel');
  const deg = 3600 + (res.win ? (sector-1)*36 : Math.floor(Math.random()*10)*36);
  wheel.style.transform = `rotate(${deg}deg)`;
}

loadBalance();
</script>
</body>
</html>
